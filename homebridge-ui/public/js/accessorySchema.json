
{
   "schema":
   {
      "$definitions":
      {
         "debug":
         {
            "title": "debug",
            "type": "boolean",
            "description": "Enables additional output in the log.",
            "default": false
         },
         "active":
         {
            "title": "active",
            "type": "string",
            "description": " If the Device is ACTIVE/INACTIVE",
            "placeHolder": " activePlaceHolder",
            "required": false,
            "condition":
            {
               "functionBody": "return ['Valve'].includes(model.type);"
            }
         },
         "currentPosition":
         {
            "title": "currentPosition",
            "type": "string",
            "placeHolder": " currentPositionPlaceHolder",
            "description": " The devices current position",
            "required": false,
            "condition":
            {
               "functionBody": "return ['Door'].includes(model.type);"
            }
         },
         "on":
         {
            "title": "on",
            "type": "string",
            "placeHolder": "onValuePlaceHolder",
            "description": " Is the Device On",
            "required": false,
            "condition":
            {
               "functionBody": "return ['Fan','Outlet','Switch'].includes(model.type);"
            }
         },
         "name":
         {
            "title": "name",
            "type": "string",
            "default": "nameDefaultValue",
            "required": true,
            "minLength": 1,
            "description": " Name of accessory, as displayed in HomeKit"
         },
         "positionState":
         {
            "title": "positionState",
            "type": "string",
            "placeHolder": "positionStatePlaceHolder",
            "description": " the devices position",
            "required": false,
            "condition":
            {
               "functionBody": "return ['Door'].includes(model.type);"
            }
         },
         "rotationDirection": {
            "title": "rotationDirection",
            "type": "string",
            "placeHolder": "rotationDirectionPlaceHolder",
            "description": " The Current Direction of Rotation",
            "required": false,
            "condition":
            {
               "functionBody": "return ['Fan'].includes(model.type);"
            }
         },
         "rotationSpeed": {
            "title": "rotationSpeed",
            "type": "string",
            "placeHolder": "rotationSpeedPlaceHolder",
            "description": " The Current Speed of Rotation",
            "required": false,
            "condition":
            {
               "functionBody": "return ['Fan'].includes(model.type);"
            }
         },
         "valveType":
         {
            "title": "valveType",
            "type": "string",
            "placeHolder": "valveTypePlaceHolder",
            "description": " The Devices Valve Type",
            "required": false,
            "condition":
            {
               "functionBody": "return ['Valve'].includes(model.type);"
            }
         },
         "type": {
            "type": "string",
            "title": "type",
            "description": "Select the Accessory Type.",
            "default": "Switch",
            "oneOf":
            [
                { "title": "Door", "enum": ["Door"] },
                { "title": "Fan", "enum": ["Fan"] },

                { "title": "Lightbulb", "enum": ["Lightbulb"] },
                { "title": "Switch", "enum": ["Switch"] },
                { "title": "Valve", "enum": ["Valve"] }
            ]
         },
         "polling":
         {
            "title": "polling",
            "type": "array",
            "uniqueItems": true,
            "required": false,
            "items":
            {
               "type": "object",
               "properties":
               {
                  "characteristic":
                  {  "type": "string",
                     "oneOf": [
                        {"characteristic": "active","enum": ["active"] },
                        { "characteristic": "on", "enum": ["on" ]}
                     ]
                  },
                  "stateChangeResponseTime":
                  {
                     "type": "integer",
                     "placeholder": 3000,
                     "required": false
                  },
                  "timeout":
                  {
                     "type": "integer",
                     "placeholder": 60000,
                     "required": false
                  },
                  "interval":
                  {
                     "type": "integer",
                     "placeholder": 60000,
                     "required": false
                  },
                  "queue":
                  {
                     "type": "string",
                     "required": false
                  }
               }
            }
         }
      },
      "type": "object",
      "properties":
      {
         "debug": { "$ref": "#/$definitions/debug" },
         "type": { "$ref": "#/$definitions/type" },
         "name": { "$ref": "#/$definitions/name" },
         "on": { "$ref": "#/$definitions/on" },
         "active": { "$ref": "#/$definitions/active" },
         "positionState": { "$ref": "#/$definitions/positionState" },
         "rotationDirection": { "$ref": "#/$definitions/rotationDirection" },
         "rotationSpeed": { "$ref": "#/$definitions/rotationSpeed" },
         "valveType": { "$ref": "#/$definitions/valveType" },
         "polling": { "$ref": "#/$definitions/polling" }
      }
   },
   "layout":
   [  {  "key": "debug",
         "type": "boolean"
      },
      {  "key": "type",
         "$ref": "#/$definitions/type"
      },
      {
         "type": "fieldset",
         "expandable": true,
         "title": "Fan Required Characteristics",
         "condition": {
             "functionBody": "return ['Fan'].includes(model.type);"
         },
         "items": [
            "on",
            "rotationSpeed",
            "rotationDirection"
         ]
      },
      {
         "type": "fieldset",
         "expandable": true,
         "title": "Door Required Characteristics",
         "condition": {
             "functionBody": "return ['Door'].includes(model.type);"
         },
         "items": [
            "positionState"
         ]
      },
      {
         "type": "fieldset",
         "expandable": true,
         "title": "Lightbulb Required Characteristics",
         "condition": {
             "functionBody": "return ['Lightbulb'].includes(model.type);"
         },
         "items": [
            "on"
         ]
      },
      {
         "type": "fieldset",
         "expandable": true,
         "title": "Switch/Outlet Required Characteristics",
         "condition": {
             "functionBody": "return ['Switch', 'Outlet'].includes(model.type);"
         },
         "items": [
            "on"
         ]
      },
      {
         "type": "fieldset",
         "expandable": true,
         "title": "Valve Required Characteristics",
         "condition": {
             "functionBody": "return ['Valve'].includes(model.type);"
         },
         "items": [
            "active",
            "valveType"
         ]
      },
      {  "key": "name",
         "$ref": "#/$definitions/name",
         "condition": {
            "functionBody": "return model.type && model.type !== 'null';"
         }
      },
      {
         "type": "fieldset",
         "expandable": true,
         "title": "Polling Required Characteristics",
         "condition": {
             "functionBody": "return model.type && model.type !== 'null';"
         },
         "items": [
         {  "key": "polling",
            "type": "array",
            "listItems": 1,
            "items":
            [{  "type": "div",
                "displayFlex": true,
                "flex-direction": "row",
                "items":
                [{
                    "key": "polling[].characteristic", "flex": "1 1 100px",
                    "notitle": false, "placeholder": "AQueueName"
                },
                {  "key": "polling[].stateChangeResponseTime", "flex": "4 4 150px",
                   "notitle": false
                },
                {
                   "key": "polling[].interval", "flex": "1 1 50px",
                   "notitle": false
                }]
            }]
         }]
      }
   ]
}
